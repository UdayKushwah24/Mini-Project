<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floor Plan Editor</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/panels.css">
    <link rel="stylesheet" href="css/tools.css">
</head>
<body>
    <!-- Main Container -->
    <div class="container">
        
        <!-- Header / Toolbar -->
        <header class="toolbar">
            <div class="toolbar-section">
                <h1>
                    <svg class="logo-icon" width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 22V12h6v10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Floor Plan Editor
                </h1>
                <span class="version">v2.0</span>
            </div>
            <div class="toolbar-section">
                <button id="undoBtn" class="btn-icon" title="Undo (Ctrl+Z)" disabled>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <path d="M3 7v6h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <button id="redoBtn" class="btn-icon" title="Redo (Ctrl+Y)" disabled>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <path d="M21 7v6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
                <div class="toolbar-divider"></div>
                <button id="importBtn" class="btn btn-secondary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M17 8l-5-5-5 5M12 3v12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Import
                </button>
                <button id="exportBtn" class="btn btn-primary">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Export
                </button>
                <input type="file" id="fileInput" accept=".json" style="display: none;">
            </div>
        </header>

        <!-- Tools Panel -->
        <div class="tools-bar">
            <div class="tool-group">
                <button class="tool-btn active" data-tool="select" title="Select (V)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <path d="M3 3l7.07 16.97 2.51-7.39 7.39-2.51L3 3z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="tool-label">Select</span>
                </button>
                <button class="tool-btn" data-tool="room" title="Draw Room (R)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                        <path d="M9 3v18M3 9h18M3 15h18M15 3v18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="tool-label">Room</span>
                </button>
                <button class="tool-btn" data-tool="wall" title="Draw Wall (W)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="9" width="18" height="6" stroke="currentColor" stroke-width="2" fill="currentColor" fill-opacity="0.2"/>
                        <path d="M3 9h18M3 15h18" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="tool-label">Wall</span>
                </button>
                <button class="tool-btn" data-tool="door" title="Add Door (D)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="6" y="3" width="12" height="18" rx="1" stroke="currentColor" stroke-width="2"/>
                        <circle cx="15" cy="12" r="1.5" fill="currentColor"/>
                        <path d="M6 3l10 10" stroke="currentColor" stroke-width="1.5" stroke-dasharray="2 2"/>
                    </svg>
                    <span class="tool-label">Door</span>
                </button>
                <button class="tool-btn" data-tool="window" title="Add Window (N)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="4" y="8" width="16" height="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M4 12h16M12 8v8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="tool-label">Window</span>
                </button>
                <button class="tool-btn" data-tool="fixture" title="Add Fixture (F)">
                    <svg class="tool-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                        <rect x="3" y="8" width="8" height="12" rx="1" stroke="currentColor" stroke-width="2"/>
                        <rect x="13" y="8" width="8" height="12" rx="1" stroke="currentColor" stroke-width="2"/>
                        <path d="M3 13h8M13 13h8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    <span class="tool-label">Fixture</span>
                </button>
            </div>
            <div class="tool-group">
                <button id="zoomIn" class="btn-icon" title="Zoom In (+)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35M11 8v6M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button id="zoomOut" class="btn-icon" title="Zoom Out (-)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                        <path d="M21 21l-4.35-4.35M8 11h6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </button>
                <button id="fitView" class="btn-icon" title="Fit View (F)">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                        <path d="M8 3H5a2 2 0 00-2 2v3m18 0V5a2 2 0 00-2-2h-3m0 18h3a2 2 0 002-2v-3M3 16v3a2 2 0 002 2h3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="content">
            
            <!-- Canvas Section -->
            <div class="canvas-container">
                <canvas id="floorCanvas"></canvas>
                <div class="canvas-info">
                    <span id="canvasCoords">0, 0 ft</span>
                </div>
                
                <!-- Floating Scale Control -->
                <div class="floating-scale-panel" id="floatingScalePanel">
                    <button class="scale-toggle-btn" id="floatingScaleToggle" title="Toggle Scale Controls">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
                            <path d="M3 9h18M3 15h18M9 3v18M15 3v18" stroke="currentColor" stroke-width="1.5"/>
                        </svg>
                        <span class="scale-value" id="floatingScaleValue">10 px/ft</span>
                    </button>
                    <div class="floating-scale-content hidden" id="floatingScaleContent">
                        <div class="scale-slider-group">
                            <label>Scale: <span id="sliderValue">10</span> px/ft</label>
                            <input type="range" id="scaleSlider" min="5" max="30" value="10" step="1">
                            <div class="scale-quick-btns">
                                <button class="quick-scale-btn" data-scale="5">5</button>
                                <button class="quick-scale-btn" data-scale="10">10</button>
                                <button class="quick-scale-btn active" data-scale="15">15</button>
                                <button class="quick-scale-btn" data-scale="20">20</button>
                                <button class="quick-scale-btn" data-scale="25">25</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <aside class="sidebar">
                
                <!-- Map Info Panel -->
                <div class="panel" id="mapInfoPanel">
                    <h3>Map Information</h3>
                    <div class="form-group">
                        <label for="mapTitle">Title:</label>
                        <input type="text" id="mapTitle" placeholder="Floor Plan Title">
                    </div>
                    <div class="form-group">
                        <label for="mapAuthor">Author:</label>
                        <input type="text" id="mapAuthor" placeholder="Designer Name">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="mapDate">Date:</label>
                            <input type="date" id="mapDate" class="input-compact">
                        </div>
                        <div class="form-group">
                            <label for="mapScale">Scale:</label>
                            <input type="text" id="mapScale" placeholder="1:100" class="input-compact">
                        </div>
                    </div>
                </div>

                <!-- Plot Settings Panel -->
                <div class="panel" id="plotPanel">
                    <h3>Plot Settings</h3>
                    
                    <!-- Canvas Scale Section (Collapsible) -->
                    <div class="collapsible-section">
                        <button class="collapse-header collapsed" id="scaleToggle">
                            <svg class="collapse-icon" width="14" height="14" viewBox="0 0 24 24" fill="none">
                                <path d="M19 9l-7 7-7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            <span>Canvas Scale</span>
                            <span class="badge" id="scaleBadge">10 px/ft</span>
                        </button>
                        <div class="collapse-content hidden" id="scaleContent">
                            <div class="form-group">
                                <label for="canvasScale">
                                    <span>Scale (px/ft):</span>
                                    <span class="help-text">Use Shift+Wheel to adjust</span>
                                </label>
                                <div class="scale-control">
                                    <button id="scaleDecrease" class="btn-icon-small" title="Decrease scale">âˆ’</button>
                                    <input type="number" id="canvasScale" value="10" min="5" max="30" step="1" class="input-compact">
                                    <button id="scaleIncrease" class="btn-icon-small" title="Increase scale">+</button>
                                </div>
                                <div class="scale-presets">
                                    <button class="preset-btn" data-scale="5">Tiny</button>
                                    <button class="preset-btn" data-scale="10">Small</button>
                                    <button class="preset-btn active" data-scale="15">Medium</button>
                                    <button class="preset-btn" data-scale="20">Large</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Plot Dimensions -->
                    <div class="form-row">
                        <div class="form-group">
                            <label for="plotLength">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" style="vertical-align: middle;">
                                    <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Length (ft):
                            </label>
                            <input type="number" id="plotLength" value="50" min="10" max="200">
                        </div>
                        <div class="form-group">
                            <label for="plotWidth">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" style="vertical-align: middle;">
                                    <path d="M12 5v14M5 12l7-7 7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                Width (ft):
                            </label>
                            <input type="number" id="plotWidth" value="30" min="10" max="200">
                        </div>
                    </div>
                    
                    <!-- Setbacks -->
                    <div class="form-group">
                        <label>
                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" style="vertical-align: middle;">
                                <rect x="3" y="3" width="18" height="18" stroke="currentColor" stroke-width="2" fill="none"/>
                                <rect x="7" y="7" width="10" height="10" stroke="currentColor" stroke-width="2" fill="currentColor" fill-opacity="0.1"/>
                            </svg>
                            Setbacks (ft):
                        </label>
                        <div class="setback-grid">
                            <input type="number" id="setbackFront" value="5" step="0.5" placeholder="Front" class="input-compact">
                            <input type="number" id="setbackRear" value="3" step="0.5" placeholder="Rear" class="input-compact">
                            <input type="number" id="setbackLeft" value="3" step="0.5" placeholder="Left" class="input-compact">
                            <input type="number" id="setbackRight" value="3" step="0.5" placeholder="Right" class="input-compact">
                        </div>
                    </div>
                </div>

                <!-- Summary Panel -->
                <div class="panel" id="summaryPanel">
                    <h3>Summary</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <label>Plot Area:</label>
                            <span id="plotArea">1500 sqft</span>
                        </div>
                        <div class="summary-item">
                            <label>Built-up Area:</label>
                            <span id="builtUpArea">0 sqft</span>
                        </div>
                        <div class="summary-item">
                            <label>Coverage:</label>
                            <span id="coverage">0%</span>
                        </div>
                        <div class="summary-item">
                            <label>Rooms:</label>
                            <span id="roomCount">0</span>
                        </div>
                        <div class="summary-item">
                            <label>Walls:</label>
                            <span id="wallCount">0</span>
                        </div>
                        <div class="summary-item">
                            <label>Doors:</label>
                            <span id="doorCount">0</span>
                        </div>
                        <div class="summary-item">
                            <label>Windows:</label>
                            <span id="windowCount">0</span>
                        </div>
                        <div class="summary-item">
                            <label>Fixtures:</label>
                            <span id="fixtureCount">0</span>
                        </div>
                    </div>
                </div>

                <!-- Properties Panel (Dynamic) -->
                <div class="panel" id="propertiesPanel">
                    <h3>Properties</h3>
                    <div id="propertiesContent">
                        <p class="placeholder">Select an element to edit</p>
                    </div>
                </div>

                <!-- Elements List -->
                <div class="panel" id="elementsPanel">
                    <h3>Elements</h3>
                    <div class="tabs">
                        <button class="tab-btn active" data-tab="rooms">Rooms</button>
                        <button class="tab-btn" data-tab="walls">Walls</button>
                        <button class="tab-btn" data-tab="openings">Openings</button>
                        <button class="tab-btn" data-tab="fixtures">Fixtures</button>
                    </div>
                    <div id="elementsContent" class="elements-list">
                        <p class="placeholder">No elements yet</p>
                    </div>
                </div>

            </aside>
        </div>
    </div>

    <!-- Load JavaScript Modules -->
    <script src="js/notifications.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/canvas.js"></script>
    <script src="js/rooms.js"></script>
    <script src="js/walls.js"></script>
    <script src="js/doors.js"></script>
    <script src="js/windows.js"></script>
    <script src="js/fixtures.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/io.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
